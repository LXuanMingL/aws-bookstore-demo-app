{"ast":null,"code":"import _regeneratorRuntime from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/home/xl355/341/aws-bookstore-demo-app/assets/src/modules/checkout/checkoutForm/CheckoutForm.tsx\";\nimport React from \"react\";\nimport { FormGroup, FormControl, ControlLabel, Form } from \"react-bootstrap\";\nimport \"./checkoutForm.css\";\nimport supportedCards from \"../../../images/supportedCards.png\";\nimport { API } from \"aws-amplify\";\nimport { Redirect } from \"react-router\";\nexport var CheckoutForm = /*#__PURE__*/function (_React$Component) {\n  _inherits(CheckoutForm, _React$Component);\n\n  var _super = _createSuper(CheckoutForm);\n\n  function CheckoutForm(props) {\n    var _this;\n\n    _classCallCheck(this, CheckoutForm);\n\n    _this = _super.call(this, props);\n\n    _this.getOrderTotal = function () {\n      return _this.state.orders.reduce(function (total, book) {\n        return total + book.price * book.quantity;\n      }, 0).toFixed(2);\n    };\n\n    _this.handleChange = function (event) {\n      var target = event.target;\n\n      _this.setState(_objectSpread(_objectSpread({}, _this.state), {}, _defineProperty({}, target.name, target.value)));\n    };\n\n    _this.onCheckout = function () {\n      var orders = _this.state.orders;\n      API.post(\"orders\", \"/orders\", {\n        body: {\n          books: orders\n        }\n      }).then(function () {\n        return _this.setState({\n          toConfirm: true\n        });\n      });\n    };\n\n    _this.state = {\n      card: '1010101010101010',\n      expDate: undefined,\n      ccv: '123',\n      isLoading: true,\n      toCart: false,\n      orders: [],\n      toConfirm: false\n    };\n    return _this;\n  }\n\n  _createClass(CheckoutForm, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var orders;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.listOrdersInCart();\n\n              case 3:\n                orders = _context.sent;\n                this.setState({\n                  orders: orders\n                });\n                _context.next = 10;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n                alert(_context.t0);\n\n              case 10:\n                this.setState({\n                  isLoading: false\n                });\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 7]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"listOrdersInCart\",\n    value: function listOrdersInCart() {\n      return API.get(\"cart\", \"/cart\", null);\n    }\n  }, {\n    key: \"getCardNumberValidationState\",\n    value: function getCardNumberValidationState() {\n      var length = this.state.card.length;\n      if (length >= 15 && length <= 19) return 'success';else if (length !== 0 && (length < 15 || length > 19)) return 'error';\n      return null;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.toConfirm) return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/checkout-confirm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 38\n        }\n      });\n      if (this.state.isLoading) return null;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"well-bs col-md-12 full-page no-padding-top\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"white-box no-margin-top\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"checkout \",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: supportedCards,\n        alt: \"Supported cards\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(Form, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(FormGroup, {\n        controlId: \"card\",\n        validationState: this.getCardNumberValidationState(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(ControlLabel, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 17\n        }\n      }, \"Card number\"), /*#__PURE__*/React.createElement(FormControl, {\n        name: \"card\",\n        type: \"text\",\n        value: this.state.card,\n        onChange: this.handleChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(FormControl.Feedback, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(FormGroup, {\n        controlId: \"expDate\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(ControlLabel, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 19\n        }\n      }, \"Expiration date\"), /*#__PURE__*/React.createElement(FormControl, {\n        name: \"expDate\",\n        type: \"date\",\n        value: this.state.expDate,\n        onChange: this.handleChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(FormControl.Feedback, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 19\n        }\n      })), /*#__PURE__*/React.createElement(FormGroup, {\n        className: \"ccv\",\n        controlId: \"ccv\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(ControlLabel, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 19\n        }\n      }, \"CCV\"), /*#__PURE__*/React.createElement(FormControl, {\n        name: \"ccv\",\n        type: \"text\",\n        value: this.state.ccv,\n        onChange: this.handleChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(FormControl.Feedback, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 19\n        }\n      })))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pull-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-black\",\n        type: \"button\",\n        onClick: this.onCheckout,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }\n      }, \"Pay ($\".concat(this.getOrderTotal(), \")\"))));\n    }\n  }]);\n\n  return CheckoutForm;\n}(React.Component);\nexport default CheckoutForm;","map":{"version":3,"names":["React","FormGroup","FormControl","ControlLabel","Form","supportedCards","API","Redirect","CheckoutForm","props","getOrderTotal","state","orders","reduce","total","book","price","quantity","toFixed","handleChange","event","target","setState","name","value","onCheckout","post","body","books","then","toConfirm","card","expDate","undefined","ccv","isLoading","toCart","listOrdersInCart","alert","get","length","getCardNumberValidationState","Component"],"sources":["/home/xl355/341/aws-bookstore-demo-app/assets/src/modules/checkout/checkoutForm/CheckoutForm.tsx"],"sourcesContent":["import React from \"react\";\nimport { FormGroup, FormControl, ControlLabel, Form, FormControlProps } from \"react-bootstrap\";\n\nimport \"./checkoutForm.css\";\nimport supportedCards from \"../../../images/supportedCards.png\";\nimport { API } from \"aws-amplify\";\nimport { Redirect } from \"react-router\";\n\ninterface CheckoutFormProps {}\n\ninterface CheckoutFormState {\n  card: string;\n  expDate: string | undefined;\n  ccv: string;\n  isLoading: boolean;\n  toCart: boolean;\n  orders: any[];\n  toConfirm: boolean;\n}\n\nexport class CheckoutForm extends React.Component<CheckoutFormProps, CheckoutFormState> {\n  constructor(props: CheckoutFormProps) {\n    super(props);\n\n    this.state = {\n      card: '1010101010101010',\n      expDate: undefined,\n      ccv: '123',\n      isLoading: true,\n      toCart: false,\n      orders: [],\n      toConfirm: false,\n    };\n  }\n\n  async componentDidMount() {\n    try {\n      const orders = await this.listOrdersInCart();\n      this.setState({\n        orders: orders\n      });\n    } catch (e) {\n      alert(e);\n    }\n\n    this.setState({ isLoading: false });\n  }\n\n  listOrdersInCart() {\n    return API.get(\"cart\", \"/cart\", null);\n  }\n\n  getOrderTotal = () => {\n    return this.state.orders.reduce((total, book) => {\n      return total + book.price * book.quantity\n    }, 0).toFixed(2);\n  }\n\n  getCardNumberValidationState() {\n    const length = this.state.card.length;\n    if (length >= 15 && length <= 19) return 'success';\n    else if (length !== 0 && (length < 15 || length > 19)) return 'error';\n    return null;\n  }\n\n  handleChange = (event: React.FormEvent<FormControl>) => {\n    const target = event.target as HTMLInputElement\n    this.setState({ \n      ...this.state,\n      [target.name as any]: target.value\n    });\n  }\n\n  onCheckout = () => {\n    const orders = this.state.orders;\n    API.post(\"orders\", \"/orders\", {\n      body: {\n        books: orders\n      }\n    }).then(() => this.setState({\n      toConfirm: true\n    }));\n  }\n\n  render() {\n    if (this.state.toConfirm) return <Redirect to='/checkout-confirm' />\n\n    if (this.state.isLoading) return null;\n    return (\n      <div className=\"well-bs col-md-12 full-page no-padding-top\">\n        <div className=\"white-box no-margin-top\">\n          <div className=\"checkout \">\n            <img src={supportedCards} alt=\"Supported cards\" />\n            <Form>\n              <FormGroup\n                controlId=\"card\"\n                validationState={this.getCardNumberValidationState()}>\n                <ControlLabel>Card number</ControlLabel>\n                <FormControl\n                  name=\"card\"\n                  type=\"text\"\n                  value={this.state.card}\n                  onChange={this.handleChange} />\n                <FormControl.Feedback />\n              </FormGroup>\n              <div className=\"form-row\">\n                <FormGroup\n                  controlId=\"expDate\">\n                  <ControlLabel>Expiration date</ControlLabel>\n                  <FormControl\n                    name=\"expDate\"\n                    type=\"date\"\n                    value={this.state.expDate}\n                    onChange={this.handleChange} />\n                  <FormControl.Feedback />\n                </FormGroup>\n                <FormGroup\n                  className=\"ccv\"\n                  controlId=\"ccv\">\n                  <ControlLabel>CCV</ControlLabel>\n                  <FormControl\n                    name=\"ccv\"\n                    type=\"text\"\n                    value={this.state.ccv}\n                    onChange={this.handleChange} />\n                  <FormControl.Feedback />\n                </FormGroup>\n              </div>\n            </Form>\n          </div>\n        </div>\n        <div className=\"pull-right\">\n          <button className=\"btn btn-black\" type=\"button\" onClick={this.onCheckout}>{`Pay ($${this.getOrderTotal()})`}</button>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default CheckoutForm;\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}