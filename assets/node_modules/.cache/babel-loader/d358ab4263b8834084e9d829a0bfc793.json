{"ast":null,"code":"import _regeneratorRuntime from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/xl355/341/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/home/xl355/341/aws-bookstore-demo-app/assets/src/modules/pastPurchases/PastPurchases.tsx\";\nimport React, { Component } from \"react\";\nimport { CategoryNavBar } from \"../category/categoryNavBar/CategoryNavBar\";\nimport { SearchBar } from \"../search/searchBar/SearchBar\";\nimport \"../../common/hero/hero.css\";\nimport { PurchasedProductRow } from \"./PurchasedProductRow\";\nimport { Auth, API } from \"aws-amplify\";\nimport bestSellers from \"../../images/bestSellers.png\";\nimport yourshoppingcart from \"../../images/yourshoppingcart.png\";\n\nvar PastPurchases = /*#__PURE__*/function (_Component) {\n  _inherits(PastPurchases, _Component);\n\n  var _super = _createSuper(PastPurchases);\n\n  function PastPurchases(props) {\n    var _this;\n\n    _classCallCheck(this, PastPurchases);\n\n    _this = _super.call(this, props);\n\n    _this.getPrettyDate = function (orderDate) {\n      var date = new Date(orderDate);\n      return \"\".concat(date.getMonth(), \"/\").concat(date.getDate(), \"/\").concat(date.getFullYear(), \" \").concat(date.getHours(), \":\").concat(date.getMinutes() < 10 ? '0' : '').concat(date.getMinutes());\n    };\n\n    _this.state = {\n      userInfo: null,\n      isLoading: true,\n      orders: []\n    };\n    return _this;\n  }\n\n  _createClass(PastPurchases, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var userInfo, orders;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return Auth.currentUserInfo();\n\n              case 2:\n                userInfo = _context.sent;\n                this.setState({\n                  userInfo: userInfo\n                });\n                _context.prev = 4;\n                _context.next = 7;\n                return this.listOrders();\n\n              case 7:\n                orders = _context.sent;\n                this.setState({\n                  orders: orders,\n                  isLoading: false\n                });\n                _context.next = 14;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context[\"catch\"](4);\n                alert(_context.t0);\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[4, 11]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"listOrders\",\n    value: function listOrders() {\n      return API.get(\"orders\", \"/orders\", null);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"Category\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(SearchBar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(CategoryNavBar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"well-bs col-md-12\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 9\n        }\n      }, this.state.userInfo && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"white-box no-margin-top\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 35\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 13\n        }\n      }, \"Hello \".concat(this.state.userInfo.attributes.email, \"!\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"white-box\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 13\n        }\n      }, \"Past purchases\")), !this.state.isLoading && this.state.orders && this.state.orders.sort(function (order1, order2) {\n        return order2.orderDate - order1.orderDate;\n      }).map(function (order) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: \"order-date\",\n          key: order.orderId,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"h4\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 17\n          }\n        }, \"Order date: \".concat(_this2.getPrettyDate(order.orderDate))), order.books.map(function (book) {\n          return /*#__PURE__*/React.createElement(PurchasedProductRow, {\n            order: book,\n            key: book.bookId,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 44\n            }\n          });\n        }));\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"well-bs no-margin-top no-padding col-md-12\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/best\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: bestSellers,\n        alt: \"Best sellers\",\n        className: \"checkout-img no-padding\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 27\n        }\n      })), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/cart\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: yourshoppingcart,\n        alt: \"Shopping cart\",\n        className: \"checkout-img no-padding\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 27\n        }\n      })))));\n    }\n  }]);\n\n  return PastPurchases;\n}(Component);\n\nexport { PastPurchases as default };","map":{"version":3,"names":["React","Component","CategoryNavBar","SearchBar","PurchasedProductRow","Auth","API","bestSellers","yourshoppingcart","PastPurchases","props","getPrettyDate","orderDate","date","Date","getMonth","getDate","getFullYear","getHours","getMinutes","state","userInfo","isLoading","orders","currentUserInfo","setState","listOrders","alert","get","attributes","email","sort","order1","order2","map","order","orderId","books","book","bookId"],"sources":["/home/xl355/341/aws-bookstore-demo-app/assets/src/modules/pastPurchases/PastPurchases.tsx"],"sourcesContent":["import React, { Component } from \"react\";\nimport { CategoryNavBar } from \"../category/categoryNavBar/CategoryNavBar\";\nimport { SearchBar } from \"../search/searchBar/SearchBar\";\nimport \"../../common/hero/hero.css\";\nimport { PurchasedProductRow } from \"./PurchasedProductRow\";\nimport { Auth, API } from \"aws-amplify\";\nimport bestSellers from \"../../images/bestSellers.png\";\nimport yourshoppingcart from \"../../images/yourshoppingcart.png\";\nimport { Order } from \"../cart/CartProductRow\";\n\ninterface PastPurchasesProps {}\n\ninterface Purchases {\n  orderDate: number;\n  orderId: string;\n  books: Order[];\n}\n\ninterface PastPurchasesState {\n  userInfo: any; // FIXME\n  isLoading: boolean;\n  orders: Purchases[];\n}\n\nexport default class PastPurchases extends Component<PastPurchasesProps, PastPurchasesState> {\n  constructor(props: PastPurchasesProps) {\n    super(props);\n\n    this.state = {\n      userInfo: null,\n      isLoading: true,\n      orders: []\n    };\n  }\n\n  async componentDidMount() {\n    const userInfo = await Auth.currentUserInfo();\n    this.setState({ userInfo })\n\n    try {\n      const orders = await this.listOrders();\n      this.setState({ \n        orders: orders,\n        isLoading: false\n     });\n    } catch (e) {\n      alert(e);\n    }\n  }\n\n  listOrders() {\n    return API.get(\"orders\", \"/orders\", null);\n  }\n\n  getPrettyDate = (orderDate: number) => {\n    const date = new Date(orderDate);\n    return `${date.getMonth()}/${date.getDate()}/${date.getFullYear()} ${date.getHours()}:${date.getMinutes() < 10 ? '0' : ''}${date.getMinutes()}`\n  }\n\n  render() {\n    return (\n      <div className=\"Category\">\n        <SearchBar />\n        <CategoryNavBar />\n        <div className=\"well-bs col-md-12\">\n          {this.state.userInfo && <div className=\"white-box no-margin-top\">\n            <h3>{`Hello ${this.state.userInfo.attributes.email}!`}</h3>\n          </div>}\n          <div className=\"white-box\">\n            <h3>Past purchases</h3>\n          </div>\n          {!this.state.isLoading && this.state.orders && this.state.orders\n            .sort((order1, order2) => order2.orderDate - order1.orderDate)\n            .map(order => \n              <div className=\"order-date\" key={order.orderId}>\n                <h4>{`Order date: ${this.getPrettyDate(order.orderDate)}`}</h4>\n                {order.books.map((book) => <PurchasedProductRow order={book} key={book.bookId} />)}\n              </div>)\n          }\n          \n          <div className=\"well-bs no-margin-top no-padding col-md-12\">\n          <a href=\"/best\"><img src={bestSellers} alt=\"Best sellers\" className=\"checkout-img no-padding\" /></a>\n          <a href=\"/cart\"><img src={yourshoppingcart} alt=\"Shopping cart\" className=\"checkout-img no-padding\" /></a>\n          \n          </div>\n        </div>\n      </div>\n    );\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}